#Using the boston_house_price dataset, model Medv as the target variable. Complete the following tasks:

#Stacking regressor: Design and implement an optimised stacking regressor using four strong base regression models, and assess its performance using RMSE under 5-fold cross-validation.

import pandas as pd
from sklearn.preprocessing import LabelEncoder,StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor,StackingRegressor
from sklearn.neighbors import KNeighborsRegressor
from sklearn.model_selection import cross_val_score
from sklearn.svm import SVR

df=pd.read_csv('boston_house_prices.csv')
X=df.drop('MEDV', axis=1)
Y=df['MEDV']
estimators=[
    ('rf',RandomForestRegressor(n_estimators=10,random_state=42)),
    ('lr',LinearRegression()),
    ('svr',SVR()),
    ('knn',KNeighborsRegressor())
]
Stack=StackingRegressor(estimators=estimators,final_estimator=LinearRegression())
scores=cross_val_score(Stack,X,Y,cv=5,scoring='neg_root_mean_squared_error')
scores_mean = -scores.mean()  # Remove negative for RMSE
scores_std = scores.std()

print("Mean RMSE:", scores_mean)
print("Std RMSE:", scores_std)
print("All fold RMSEs:", -scores)
